<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cesta</title>
  </head>
  <body>
    <style>
      /* CSS for the shopping cart */
      body {
        font-family: Arial, sans-serif;
        background-color: #f9f9f9; /* Light neutral background */
        color: #333; /* Dark text for readability */
        margin: 0;
        padding: 20px;
        text-align: center;
      }

      #items {
        display: flex; /* Use flexbox for layout */
        flex-direction: column; /* Stack items vertically */
        align-items: center; /* Center items horizontally */
        margin-bottom: 20px;
    }

    #item {
        background-color: #fff; /* White background for items */
        border: 1px solid #ccc; /* Light border for definition */
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 15px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        width: 500px; /* Set a fixed width for items */
    }


      h1 {
        font-size: 1.5em;
        margin: 0 0 10px 0;
        color: #214e34; /* Green color for item names */
      }

      p {
        margin: 5px 0;
      }

      button {
        background-color: #7c2a2a; /* Maroon background for the button */
        color: white; /* White text for contrast */
        border: none;
        border-radius: 5px;
        padding: 10px 15px;
        font-size: 1em;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      button:hover {
        background-color: #9b2a2a; /* Darker maroon on hover */
      }

      #precio_total {
        font-weight: bold; /* Make total price bold */
      }
    </style>
    <h1>Cesta</h1>
    <p><span id="dinero"></span>€</p>
    <p onclick="back()">Volver a la tienda</p>
    <div id="items"></div>
    <p>Precio Total : <span id="precio_total">0</span>€</p>
    <button type="button" onclick="comprar()">Comprar</button>
  </body>
</html>
<script>
let dinero = localStorage.getItem("dinero") || 9999999;
let precio_total = 0;
let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
let compras_all = JSON.parse(localStorage.getItem("compras_all")) || [];

document.getElementById('dinero').innerHTML = dinero;
carrito.forEach((element) => {
document.getElementById("items").innerHTML += `
    <div id="item">
        <h1 id="nombre">${element.nombre}</h1>
        <p id="cantidad">Cantidad: ${element.cantidad}</p>
        <p id="precio">Precio unitario: ${element.precio}€</p>
        <p id="precio_item">Precio total: ${element.precioTotal}€</p>
    </div>
    `;
precio_total += element.precioTotal;   
});

document.getElementById('precio_total').innerHTML = precio_total

function back() {
    location.href="index.html"
}

function comprar() {
    console.log(compras_all)
    // si no tiene dinero no puede comprar
    if ((dinero - precio_total)<0) {
        alert("no tienes dinero! ");
    } else {
        // restamos el dinero y cesta
        dinero = dinero - precio_total;
        localStorage.setItem("dinero",dinero);
        localStorage.setItem("contador_cesta",0)
        // añadimos al array de compras_all
        console.log(compras_all)        
        compras_all += carrito;        
        // reseteamos el carrito
        carrito = [];
        localStorage.setItem("carrito",carrito);
        // alert("comprado ! ahora tienes " + dinero + "euros!")
        // location.href = "compras.html"
    }
}
</script>
